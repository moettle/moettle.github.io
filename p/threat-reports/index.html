<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="How to read and write Threat Reports"><title>Threat Reports</title>
<link rel=canonical href=https://dfir-delight.de/p/threat-reports/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Threat Reports"><meta property='og:description' content="How to read and write Threat Reports"><meta property='og:url' content='https://dfir-delight.de/p/threat-reports/'><meta property='og:site_name' content='DFIR Delight'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Incident Response'><meta property='article:tag' content='Forensics'><meta property='article:tag' content='Documentation'><meta property='article:tag' content='Threat Intelligence'><meta property='article:tag' content='Best Practice'><meta property='article:published_time' content='2023-10-04T16:30:00+00:00'><meta property='article:modified_time' content='2023-10-04T16:30:00+00:00'><meta property='og:image' content='https://dfir-delight.de/p/threat-reports/cover.jpg'><meta name=twitter:title content="Threat Reports"><meta name=twitter:description content="How to read and write Threat Reports"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://dfir-delight.de/p/threat-reports/cover.jpg'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_7c5c03fdbcb20431.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>DFIR Delight</a></h1><h2 class=site-description>A blog, dedicated to the fascinating world of Incident Response and Digital Forensics!</h2></div></header><ol class=menu-social><li><a href=mailto:dfir-delight@proton.me target=_blank title=Email rel=me><svg fill="#888a85" height="200" width="200" id="Layer_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64" enable-background="new 0 0 64 64" stroke="#888a85"><g id="SVGRepo_bgCarrier" stroke-width="0"/><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/><g id="SVGRepo_iconCarrier"><path id="Mail" d="M58.0034485 8H5.9965506c-3.3136795.0-5.9999995 2.6862001-5.9999995 6v36c0 3.3137016 2.6863203 6 5.9999995 6h52.006897c3.3137016.0 6-2.6862984 6-6V14C64.0034485 10.6862001 61.3171501 8 58.0034485 8zm4 41.1108017L43.084549 30.1919994l18.9188995-12.0555992V49.1108017zM5.9965506 10h52.006897c2.2056007.0 4 1.7943001 4 4v1.7664003l-27.5356971 17.547c-1.4902.9492989-3.3935013.9199982-4.8495998-.0703011L1.9965508 14.4694996V14c0-2.2056999 1.7944999-4 3.9999998-4zM1.9965508 16.8852005 21.182251 29.9251003 1.9965508 49.1108017V16.8852005zM58.0034485 54H5.9965506c-1.6473999.0-3.0638998-1.0021019-3.6760998-2.4278984l20.5199013-20.5200024 5.6547985 3.843401c1.0859013.7383003 2.3418007 1.1083984 3.5995998 1.1083984 1.1953011.0 2.3925018-.3339996 3.4463005-1.0048981l5.8423996-3.7230015 20.2961006 20.2961025C61.0673485 52.9978981 59.6508713 54 58.0034485 54z"/></g></svg></a></li><li><a href=https://github.com/moettle/moettle.github.io target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/moritz-oettle/ target=_blank title=LinkedIn rel=me><svg class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://dfir-delight.de/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://twitter.com/moettle_ target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/glossary/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Glossary</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/threat-reports/><img src=/p/threat-reports/cover_hu_a41464b34c803a9c.jpg srcset="/p/threat-reports/cover_hu_a41464b34c803a9c.jpg 800w, /p/threat-reports/cover_hu_a0817b2c9138f178.jpg 1600w" width=800 height=533 loading=lazy alt="Featured image of post Threat Reports"></a></div><div class=article-details><header class=article-category><a href=/categories/advanced/>Advanced</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/threat-reports/>Threat Reports</a></h2><h3 class=article-subtitle>How to read and write Threat Reports</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Oct 04, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>10 minute read</time></div></footer></div></header><section class=article-content><p>Frequently, I come across poor threat / incident response reports that seem to prioritize self-promotion over delivering valuable and actionable information. Such reports often lack crucial parts to help others in defending themselves against these threats. After finding another bad threat recently, I decided to write a constructive blog post on how to read and write threat reports.</p><h1 id=tldr>TL;DR</h1><ul><li>Include an actionable management summary</li><li>Provide a comprehensive technical timeline</li><li>Utilize the <a class=link href=https://attack.mitre.org/ target=_blank rel=noopener>MITRE ATT&amp;CK® framework</a></li><li>Provide IOCs and use a standardized way to share them. For example via a <a class=link href=https://www.misp-project.org/ target=_blank rel=noopener>MISP</a></li><li>Write Yara signatures</li><li>Write SIGMA signatures</li><li>Reference other reports about the same threat</li><li>Use a consistent Timezone, ideally UTC+0. In any case, specify the timezone you are using.</li></ul><h1 id=what-is-a-threat-report-even>What is a threat report even?</h1><p>A threat report is a document or publication that provides detailed information about specific (current) cyber threats. These reports are typically authored by cybersecurity organizations, government agencies, or security vendors with the primary objective of keeping organizations and individuals well-informed about the latest threats in the cyber space. Most often these reports are published after an IR engagement. Hence, the report usually covers a single attack, or a set of attacks performed by the same threat actor. A threat report should not be confused with a report about a threat landscape, which has a bigger picture in mind. In this article, we will delve into the specifics of threat / incident response reports.</p><h1 id=contents-of-a-threat-report>Contents of a threat report</h1><h2 id=management-summary>Management Summary</h2><p>To kick things off, let&rsquo;s address one of the often-overlooked but crucial elements missing in most threat reports: the management summary. Typically, these reports are tailored for a niche audience – those engaged in Digital Forensics and Incident Response (DFIR). Undoubtedly, the information contained therein is immensely valuable for this specific group, aiding them in fine-tuning their detection strategies for this specific attack. However, what if the incident responder reads the report and wants to prevent the attack in the future, for example by disabling Office macros or by rolling out a new security tool. The incident responder runs to the management, presents the report and urges them to action. Management looks at the report and the first sentence they see is something like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;&lt;fancy name&gt; (aka &lt;more fancy names&gt;) attacker group managed to infiltrate company XYZ by abusing 
</span></span><span class=line><span class=cl>&lt;fancy vulnerability name&gt; and deploying &lt;fancy malware name&gt;&#34;
</span></span></code></pre></div><p>In such cases, the management may find it challenging to immediately grasp the gravity of the situation, given the technical jargon and intricacies presented upfront. This is precisely where an effective management summary comes into play, providing a concise yet comprehensive overview that bridges the gap between the technical details and the need for strategic decisions at a higher level within the organization. Instead of sounding all fancy and technically sophisticated in the first section, it should rather sound something like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;Company XYZ was hacked by an attacker due to bad patch management. The impact from the attack resulted in a halt 
</span></span><span class=line><span class=cl>of production for several days, which caused X million in damage for the company. The attack could have been 
</span></span><span class=line><span class=cl>prevented through fast emergency patches.&#34;
</span></span></code></pre></div><p>Now management actually has a chance to understand what the report is trying to convey and what potential consequences could arise from the described threat.</p><p>A rule of thumb here: <strong>If is sounds cool to you as an incident responder, management won&rsquo;t understand it. If is sounds straightforward and plain, there is a higher chance that management will understand.</strong></p><p>What should be included in a management summary:</p><ol><li><strong>Clarity and Simplicity</strong>: Write in a non-technical and easily comprehensible manner.</li><li><strong>Impact Assessment</strong>: Explain the impact or damage caused by the attack, and if possible, quantify it.</li><li><strong>Incident Overview</strong>: Provide a concise description of what occurred.</li><li><strong>Preventive Measures</strong>: Offer recommendations on how to prevent a similar incident in other organizations.</li><li><strong>Visualization</strong>: Include any necessary visual aids to illustrate the attack, making it more accessible to non-technical readers.</li><li><strong>Timeline</strong>: Optionally, include a high-level timeline to demonstrate how rapidly an attack can disrupt a company.</li></ol><p>In 2022 I co-authored a threat report<a class=link href=https://www.hvs-consulting.de/public/ThreatReport-EmissaryPanda.pdf target=_blank rel=noopener>[1]</a> on a threat actor called Emissary Panda, which was harvesting major vulnerabilities like ProxyLogon at that time and engaging in industrial espionage. Since we received a lot of positive feedback from Incident Responders and managers, I would like to show you some highlights of the report, starting with the management summary. The first page after the table of contents contains an abstract, which serves as a management summary. It adheres to the tips given above and contains a summary written in non-technical terms as well as easy to understand recommendations:</p><p><img src=/p/threat-reports/Threat_Report_Emissary_panda.png width=1024 height=412 srcset="/p/threat-reports/Threat_Report_Emissary_panda_hu_2a8f11aeaddd822e.png 480w, /p/threat-reports/Threat_Report_Emissary_panda_hu_cbd7999da933135b.png 1024w" loading=lazy alt="Threat Report Emissary Panda: Recommendations [1]" class=gallery-image data-flex-grow=248 data-flex-basis=596px></p><p>As you can see, the report even contains a link to a separate summary targeting management<a class=link href=https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27/ target=_blank rel=noopener>[2]</a>. Furthermore, it contains easy to understand recommendations.</p><h2 id=technical-timeline>Technical Timeline</h2><p>Now that we&rsquo;ve covered the management aspect in depth, let&rsquo;s delve into the technical aspects of a threat report. Before we go into executed commands, used malware, and attacker infrastructure, the reader needs to gain an understanding of the attack. The report should provide that in form of visualization of the attack and technical timelines.</p><p>One publisher that often combines visualization and timeline in a single, beautiful image is <a class=link href=https://thedfirreport.com target=_blank rel=noopener>The DFIR Report</a>. The following timeline was taken from one of their latest reports<a class=link href=https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/ target=_blank rel=noopener>[3]</a>. I love these timelines because they offer a quick overview as well as the most critical technical details of an attack.</p><p><img src=/p/threat-reports/Threat_Report_TheDFIRReport.png width=1024 height=888 srcset="/p/threat-reports/Threat_Report_TheDFIRReport_hu_e020ea562200f49e.png 480w, /p/threat-reports/Threat_Report_TheDFIRReport_hu_f68275bb01e87c15.png 1024w" loading=lazy alt="Threat Report “Collect, Exfiltrate, Sleep, Repeat” from The DFIR Report [3]" class=gallery-image data-flex-grow=115 data-flex-basis=276px></p><p>Another approach to presenting a technical timeline is to separate the visualization from the actual timeline by placing it in a dedicated table. This is what we did in our report<a class=link href=https://www.hvs-consulting.de/public/ThreatReport-EmissaryPanda.pdf target=_blank rel=noopener>[1]</a>.</p><p><img src=/p/threat-reports/Threat_Report_Emissary_panda_Timeline_1.png width=1024 height=737 srcset="/p/threat-reports/Threat_Report_Emissary_panda_Timeline_1_hu_e66afb1afd028e54.png 480w, /p/threat-reports/Threat_Report_Emissary_panda_Timeline_1_hu_626e75b380f88a13.png 1024w" loading=lazy alt="Threat Report Emissary Panda - Timeline [1]" class=gallery-image data-flex-grow=138 data-flex-basis=333px></p><p><img src=/p/threat-reports/Threat_Report_Emissary_panda_Timeline_2.png width=1023 height=712 srcset="/p/threat-reports/Threat_Report_Emissary_panda_Timeline_2_hu_9a086f37a47c1d8f.png 480w, /p/threat-reports/Threat_Report_Emissary_panda_Timeline_2_hu_c41025f8cd1bb200.png 1024w" loading=lazy alt="Threat Report Emissary Panda - Timeline [1]" class=gallery-image data-flex-grow=143 data-flex-basis=344px></p><p><img src=/p/threat-reports/Threat_Report_Emissary_panda_Timeline_3.png width=1024 height=450 srcset="/p/threat-reports/Threat_Report_Emissary_panda_Timeline_3_hu_a5cb77a1c30ce201.png 480w, /p/threat-reports/Threat_Report_Emissary_panda_Timeline_3_hu_2ffc63001caa1a23.png 1024w" loading=lazy alt="Threat Report Emissary Panda - Timeline [1]" class=gallery-image data-flex-grow=227 data-flex-basis=546px></p><h2 id=mapping-the-attack-to-mitre-attck>Mapping the attack to MITRE ATT&amp;CK®</h2><p>The next section delves deeper into the technical aspects of the attack by leveraging the <a class=link href=https://attack.mitre.org/ target=_blank rel=noopener>MITRE ATT&amp;CK® framework</a>. By aligning the analyzed attack with MITRE&rsquo;s tactics and procedures, defenders can swiftly grasp the attack and determine how to detect or mitigate it within their environment. The report should include a MITRE map created with the <a class=link href=https://mitre-attack.github.io/attack-navigator/ target=_blank rel=noopener>MITRE ATT&amp;CK® Navigator</a> as well as a detailed and technical description of each used technique.</p><p><img src=/p/threat-reports/Threat_Report_Emissary_panda_Mitre.png width=1024 height=741 srcset="/p/threat-reports/Threat_Report_Emissary_panda_Mitre_hu_598b49fcdea3832c.png 480w, /p/threat-reports/Threat_Report_Emissary_panda_Mitre_hu_5c65791979391a63.png 1024w" loading=lazy alt="Threat Report Emissary Panda - Mitre [1]" class=gallery-image data-flex-grow=138 data-flex-basis=331px></p><p>The descriptions of the used techniques should have the highest level of technical details, including the tools used, command-lines, and more. Why? Let me illustrate that with an example from another threat report we released in 2021 about Lazarus<a class=link href=https://www.hvs-consulting.de/public/ThreatReport-Lazarus.pdf target=_blank rel=noopener>[4]</a>, a North Korean threat actor:</p><p><img src=/p/threat-reports/Threat_Report_Emissary_panda_Mitre_technique.png width=1024 height=352 srcset="/p/threat-reports/Threat_Report_Emissary_panda_Mitre_technique_hu_c4f5234c258662c6.png 480w, /p/threat-reports/Threat_Report_Emissary_panda_Mitre_technique_hu_fe2f053672175846.png 1024w" loading=lazy alt="Threat Report Lazarus - Mitre Technique Description [4]" class=gallery-image data-flex-grow=290 data-flex-basis=698px></p><p>In that report, we disclosed the entire command-line, including the password used to decrypt the embedded payload. Approximately 1.5 years later, an incident responder from ESET encountered another attack from Lazarus, still employing the same malware. Although, the ESET researchers were not able to catch the password live from the command-line, they found our report and were able to decrypt the payload with the contained password used in the command-line <a class=link href=https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/ target=_blank rel=noopener>[5]</a>.</p><h2 id=detection>Detection</h2><p>A threat report should empower others to detect the same attack in their environment. This is typically accomplished by sharing Indicators of Compromise (IOCs) or detection signatures.</p><h3 id=indicators-of-compromise>Indicators of Compromise</h3><p>IOCs, as described in my <a class=link href=https://dfir-delight.de/glossary target=_blank rel=noopener>Glossary</a>, encompass indicators such as filenames, hashes, URLs, domains, IPs, command lines, registry keys, and more. These indicators are crucial for detecting compromises or attacks.</p><p>However, sharing IOCs comes with several challenges, some of which I intend to explore in a dedicated blog post. For now, let me highlight the main issues associated with sharing IOCs:</p><ul><li>IOC types are only semi-standardized. The closest thing to a standardized format for IOCs can be found in the <a class=link href=https://www.misp-project.org/ target=_blank rel=noopener>MISP Project</a>. Since most people are still sharing indicators like its 1982, defenders still have to deal with poorly formatted tables in PDF and Excel sheets, and self-defined type names. You wouldn&rsquo;t believe how many ways there are to title an IPv4 address: IP, IP4, IP-v4, IPv4, etc. An IPv4 address is still one of the easy types to title, now think about how you would title registry keys, command-lines or even scheduled tasks.</li><li>Many organization lack a way of automatically applying IOCs to their monitoring and detection tools.</li><li>IOCs that are true positives today may become obsolete tomorrow. IP addresses are reused, domains are taken down, and hashes of the same malware can change due to one changed byte in the malware.</li><li>Often, IOCs are shared without context or information about their relevance in a specific attack.</li><li>Some IOCs, although they might be used by an attacker as described, have a high false-positive rate. Especially when Windows filenames are used as a means of defense evasion.</li></ul><p>Many of these challenges are addressed, at least partially, by the <a class=link href=https://www.misp-project.org/ target=_blank rel=noopener>MISP Project</a>. A MISP provides predefined IOC types, the option to tag IOCs to enhance them with additional information, and a standardized format for sharing with others. You can connect a MISP with other instances globally or simply export MISP events as a file for publication. This enables defenders to easily import the event, ensuring that the information is presented in a semi-standardized format that can be utilized within their organization via APIs.</p><p>Here are some key guidelines for sharing IOCs:</p><ul><li>If your IOCs are a picture, you are doing it wrong.</li><li>If some of your IOCs are spread over multiple lines, you are doing it wrong.</li><li>If your IOCs are only found in a PDF file, you are also doing it wrong.</li><li>At a minimum, you have to share the IOCs in a CSV with consistent type naming.</li><li>Even better is the creation and export of a MISP event.</li><li>Enrich your IOCs with metadata. Explain how, where, and when you discovered the IOC, its relevance in the attacker&rsquo;s tactics, and whether it has a high false-positive rate.</li><li>Classify your IOCs with Traffic Light Protocol (TLP) markings so that others understand how to handle them.</li></ul><p>As a defender, it&rsquo;s essential to have a MISP system in place and established processes for automatically incorporating new IOCs into your detection tools.</p><h3 id=signatures>Signatures</h3><p>The most common format for sharing <strong>detection signatures</strong> for <strong>files</strong> is YARA. YARA offers a standard for writing detection rules along with a scanner that can apply these signatures to a file system. If you have detected malware samples or other suspicious files during your incident investigation, you should bundle that knowledge in YARA signatures and share it with the community. If you&rsquo;re new to YARA, Florian Roth has provided excellent tutorials on how to write effective YARA signatures<a class=link href=https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/ target=_blank rel=noopener>[6]</a> <a class=link href=https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/ target=_blank rel=noopener>[7]</a> <a class=link href=https://cyb3rops.medium.com/how-to-post-process-yara-rules-generated-by-yargen-121d29322282 target=_blank rel=noopener>[8]</a>.</p><p>For sharing detection signatures specific to logs, <a class=link href=https://github.com/SigmaHQ/sigma target=_blank rel=noopener>SIGMA</a> is the way to go. It serves as a generic signature format for SIEM systems. To quote the SIGMA description from their repository:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;Sigma is for log files what Snort is for network traffic and YARA is for files.&#34;
</span></span></code></pre></div><p>The repository already provides a wide array of open-source signatures for common attacker techniques, along with a converter for various SIEM systems.</p><p>Other signatures might include:</p><ul><li>Network-based signatures: <a class=link href=https://www.snort.org/ target=_blank rel=noopener>Snort</a> or <a class=link href=https://suricata.io/ target=_blank rel=noopener>Surricata</a></li><li>EDR-specific hunting queries (e.g. Defender for Endpoint hunting queries written in KQL)</li></ul><h2 id=other-possible-contents-of-the-report>Other Possible Contents of the report</h2><p>In addition to the previously mentioned content, which should ideally be included in every threat report, there are several other valuable components that can enhance a threat report:</p><ul><li><strong>Malware analysis</strong>: This involves the thorough dissection and analysis of a malware sample to gain a deeper understanding of its functionality. Such analysis can provide insights into elements like Command and Control (C2) endpoints.</li><li><strong>Comparison to Previous Attacks by the Same Threat Actor</strong>: By comparing the current attack to past incidents attributed to the same threat actor, it becomes possible to identify changes in their techniques or tactics over time. This historical perspective can be invaluable for anticipating their future actions.</li><li><strong>Investigative Research</strong>: Conducting further research to uncover additional tools, infrastructure, malware samples, and other resources employed by the threat actor. This extended investigation helps in building a more comprehensive profile of the adversary&rsquo;s capabilities and activities.</li></ul><h1 id=resources>Resources</h1><ul><li><a class=link href=https://www.hvs-consulting.de/public/ThreatReport-EmissaryPanda.pdf target=_blank rel=noopener>[1]</a> <a class=link href=https://www.hvs-consulting.de/public/ThreatReport-EmissaryPanda.pdf target=_blank rel=noopener>https://www.hvs-consulting.de/public/ThreatReport-EmissaryPanda.pdf</a></li><li><a class=link href=https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27/ target=_blank rel=noopener>[2]</a> <a class=link href=https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27/ target=_blank rel=noopener>https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27/</a></li><li><a class=link href=https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/ target=_blank rel=noopener>[3]</a> <a class=link href=https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/ target=_blank rel=noopener>https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/</a></li><li><a class=link href=https://www.hvs-consulting.de/public/ThreatReport-Lazarus.pdf target=_blank rel=noopener>[4]</a> <a class=link href=https://www.hvs-consulting.de/public/ThreatReport-Lazarus.pdf target=_blank rel=noopener>https://www.hvs-consulting.de/public/ThreatReport-Lazarus.pdf</a></li><li><a class=link href=https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/ target=_blank rel=noopener>[5]</a> <a class=link href=https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/ target=_blank rel=noopener>https://www.welivesecurity.com/2022/09/30/amazon-themed-campaigns-lazarus-netherlands-belgium/</a></li><li><a class=link href=https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/ target=_blank rel=noopener>[6]</a> <a class=link href=https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/ target=_blank rel=noopener>https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/</a></li><li><a class=link href=https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/ target=_blank rel=noopener>[7]</a> <a class=link href=https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/ target=_blank rel=noopener>https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/</a></li><li><a class=link href=https://cyb3rops.medium.com/how-to-post-process-yara-rules-generated-by-yargen-121d29322282 target=_blank rel=noopener>[8]</a> <a class=link href=https://cyb3rops.medium.com/how-to-post-process-yara-rules-generated-by-yargen-121d29322282 target=_blank rel=noopener>https://cyb3rops.medium.com/how-to-post-process-yara-rules-generated-by-yargen-121d29322282</a></li></ul><blockquote><p>Cover Image by <a class=link href="https://www.freepik.com/free-photo/multi-colored-psychedelic-background_11761297.htm#page=2&amp;query=psychedelic%20pattern&amp;position=1&amp;from_view=keyword&amp;track=ais" target=_blank rel=noopener>Freepik</a></p></blockquote></section><footer class=article-footer><section class=article-tags><a href=/tags/incident-response/>Incident Response</a>
<a href=/tags/forensics/>Forensics</a>
<a href=/tags/documentation/>Documentation</a>
<a href=/tags/threat-intelligence/>Threat Intelligence</a>
<a href=/tags/best-practice/>Best Practice</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Oct 04, 2023 16:30 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/black-basta-iocs/><div class=article-image><img src=/p/black-basta-iocs/cover.1e676ab1e2919cd3a559f394654a2d57_hu_7ea634ca078b72d8.jpg width=250 height=150 loading=lazy alt="Featured image of post Black Basta - Insights from a Ransomware Response Assessment" data-key=black-basta-iocs data-hash="md5-HmdqseKRnNOlWfOUZUotVw=="></div><div class=article-details><h2 class=article-title>Black Basta - Insights from a Ransomware Response Assessment</h2></div></a></article><article class=has-image><a href=/p/favorite-resources/><div class=article-image><img src=/p/favorite-resources/cover.59640d2be6130b4dbf5f283d022b9a8a_hu_cb2c3b58f51310c.jpg width=250 height=150 loading=lazy alt="Featured image of post My Favorite DFIR and Cybersecurity Resources" data-key=favorite-resources data-hash="md5-WWQNK+YTC02/Xyg9Aiuaig=="></div><div class=article-details><h2 class=article-title>My Favorite DFIR and Cybersecurity Resources</h2></div></a></article><article class=has-image><a href=/p/dfir-glossary/><div class=article-image><img src=/p/dfir-glossary/cover.9a8d06b81586a3a2b6eb0a010dfb3de3_hu_dd68705aef806e86.jpg width=250 height=150 loading=lazy alt="Featured image of post DFIR Glossary" data-key=dfir-glossary data-hash="md5-mo0GuBWGo6K26woBDfs94w=="></div><div class=article-details><h2 class=article-title>DFIR Glossary</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 DFIR Delight</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>